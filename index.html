<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clinic Management System</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
</head>
<body>
    <div class="container">
        <h1 class="mt-5 text-center">Clinic Management System</h1>
        
        <!-- Add New Patient Form -->
        <div class="mt-4">
            <h3>Add New Patient</h3>
            <form id="patientForm">
                <div class="mb-3">
                    <label for="patientName" class="form-label">Patient Name</label>
                    <input type="text" class="form-control" id="patientName" required>
                </div>
                <div class="mb-3">
                    <label for="patientPhone" class="form-label">Phone Number</label>
                    <input type="text" class="form-control" id="patientPhone" required>
                </div>
                <div class="mb-3">
                    <label for="lastVisit" class="form-label">Last Visit</label>
                    <input type="date" class="form-control" id="lastVisit" required>
                </div>
                <div class="mb-3">
                    <label for="diagnosis" class="form-label">Diagnosis</label>
                    <input type="text" class="form-control" id="diagnosis" required>
                </div>
                <div class="mb-3">
                    <label for="totalPaid" class="form-label">Total Paid</label>
                    <input type="number" class="form-control" id="totalPaid" required>
                </div>
                <button type="submit" class="btn btn-primary">Add Patient</button>
            </form>
        </div>

        <!-- Patient List Section -->
        <div class="mt-5">
            <h3>Patient List</h3>
            <button class="btn btn-info" onclick="getPatients()">Show Patients</button>
            <ul id="patientList" class="list-group mt-3">
                <!-- Patient list will be populated here -->
            </ul>
        </div>
    </div>

    <script>
        let db;

        // فتح قاعدة بيانات IndexedDB
        const request = indexedDB.open("myDatabase", 1);

        // إنشاء مخزن البيانات إذا لم يكن موجودًا
        request.onupgradeneeded = function(event) {
            db = event.target.result;
            db.createObjectStore("patients", { keyPath: "id", autoIncrement: true });
        };

        request.onsuccess = function(event) {
            db = event.target.result;
        };

        // إضافة بيانات إلى IndexedDB
        function addPatient(patient) {
            const transaction = db.transaction(["patients"], "readwrite");
            const objectStore = transaction.objectStore("patients");
            objectStore.add(patient);
        }

        // استرجاع بيانات من IndexedDB
        function getPatients() {
            const transaction = db.transaction(["patients"], "readonly");
            const objectStore = transaction.objectStore("patients");
            const request = objectStore.getAll();
            request.onsuccess = function(event) {
                const patients = event.target.result;
                const patientList = document.getElementById("patientList");
                patientList.innerHTML = '';
                patients.forEach(patient => {
                    const li = document.createElement("li");
                    li.className = "list-group-item";
                    li.textContent = `Name: ${patient.name}, Phone: ${patient.phone}, Last Visit: ${patient.lastVisit}, Diagnosis: ${patient.diagnosis}, Total Paid: ${patient.totalPaid}`;
                    patientList.appendChild(li);
                });
            };
        }

        // التعامل مع إضافة مريض جديد
        document.getElementById("patientForm").addEventListener("submit", function(e) {
            e.preventDefault();
            const newPatient = {
                name: document.getElementById("patientName").value,
                phone: document.getElementById("patientPhone").value,
                lastVisit: document.getElementById("lastVisit").value,
                diagnosis: document.getElementById("diagnosis").value,
                totalPaid: document.getElementById("totalPaid").value
            };
            addPatient(newPatient);
            this.reset();
        });
    </script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

